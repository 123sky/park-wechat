extends ../layout

block content
    h2.page-header 停车信息列表

    table.table.table-bordered
        thead
            tr
                th(width="30%")
                    if sortby === 'title'
                        if(sortdir === 'desc')
                            a(href="/admin/parking?page="+pageNum+"&sortby=title&sortdir=asc")
                                i.fa.fa-arrow-down &nbsp;标题
                        else
                            a(href="/admin/parking?page="+pageNum+"&sortby=title&sortdir=desc")
                                i.fa.fa-arrow-up &nbsp;标题
                    else
                        a(href="/admin/parking?page="+pageNum+"&sortby=title&sortdir=desc") 标题
                th(width="30%") 简介
                th 图片
                th(width="200px")
                    if sortby === 'created'
                        if(sortdir === 'desc')
                            a(href="/admin/parking?page=" + pageNum + "&sortby=created&sortdir=asc")
                                i.fa.fa-arrow-down &nbsp;创建时间
                        else
                            a(href="/admin/parking?page=" + pageNum + "&sortby=created&sortdir=desc")
                                i.fa.fa-arrow-up &nbsp;创建时间
                    else
                        a(href="/admin/parking?page=" + pageNum + "&sortby=created&sortdir=desc") 创建时间
                
                th(width="90px")
                    if sortby === 'published'
                        if(sortdir === 'desc')
                            a(href="/admin/parking?page=" + pageNum + "&sortby=published&sortdir=asc")
                                i.fa.fa-arrow-down &nbsp;状态
                        else
                            a(href="/admin/parking?page=" + pageNum + "&sortby=published&sortdir=desc")
                                i.fa.fa-arrow-up &nbsp;状态
                    else
                        a(href="/admin/parking?page=" + pageNum + "&sortby=published&sortdir=desc") 状态


                th(width="150px") 管理
        tbody
        each parking in parkings
            tr
                td
                    a(href="/parking/view/",target="_blank")=parking.title
                td= parking.info
                td 图片
                td= moment(parking.created).format("YYYY-MM-DD HH:mm:ss")               
                td
                    if parking.published===true
                        a(href='/admin/parking/published/'+parking.id+'/false')
                            span(class="label label-success",title="点击切换") 已发布
                    else
                        a(href='/admin/parking/published/'+parking.id+'/true')
                            span(class="label label-default",title="点击切换") 未发布

                        
                td
                    a(href="/admin/parking/edit/"+parking._id,class="btn btn-sm btn-default",target="_blank") 编辑
                    span &nbsp;&nbsp;
                    a(href="/admin/parking/delete/"+parking._id,class="btn btn-sm btn-default") 删除

    if pageCount>1
        nav
            ul.pagination
                -var currentPage = 1
                while currentPage <= pageCount
                    if(currentPage === pageNum)
                        li.active
                            a(href="/admin/parking?page="+currentPage+"&sortby="+sortby+"&sortdir="+sortdir)= currentPage++
                    else
                        li
                            a(href="/admin/parking?page="+currentPage+"&sortby="+sortby+"&sortdir="+sortdir)= currentPage++
block scripts
    script $(function(){console.log('node Blog is ready')})
